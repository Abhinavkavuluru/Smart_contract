<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Farmer - Deploy Smart Contract</title>
    <script src="ethers.js"></script>
    <script defer src="contract.js"></script>
</head>
<body>

    <h2>🌾 Farmer Interface - Deploy Contract</h2>
    <form id="contractForm">
        <label>Farmer Name:</label>
        <input type="text" id="farmerName" required><br>

        <label>Product Type:</label>
        <input type="text" id="productType" required><br>

        <label>Quantity (kg):</label>
        <input type="number" id="quantity" required><br>

        <label>Price per Unit (ETH):</label>
        <input type="number" id="price" step="0.01" required><br>

        <label>Number of Years of Contract:</label>
        <input type="number" id="contractYears" required><br>

        <label>Buyer Wallet Address:</label>
        <input type="text" id="buyerWallet" required><br>

        <button type="button" onclick="deployContract()">🚀 Deploy Contract</button>
    </form>

    <h3>🔗 Contract Address (Copy this for Buyer)</h3>
    <p id="contractAddressDisplay">Not deployed yet</p>

    <hr>

    <h2>✅ Confirm Delivery</h2>
    <label>Enter Contract Address:</label>
    <input type="text" id="contractAddressInput" required>
    <button id="fetchDetailsBtn">🔍 Fetch Details</button>

    <div id="contractDetails"></div>

    <!-- ✅ Confirm Delivery Button (Initially Disabled) -->
    <button id="confirmDeliveryBtn" disabled>✅ Confirm Delivery</button>

    <script>
        document.getElementById("fetchDetailsBtn").addEventListener("click", function () {
            const contractAddress = document.getElementById("contractAddressInput").value.trim();
            
            if (!contractAddress) {
                alert("❌ Please enter a valid contract address.");
                return;
            }

            // Simulating contract details retrieval
            document.getElementById("contractDetails").innerHTML = `
                <p>👨‍🌾 Farmer: 0x9965507D1a55bcC2695C58ba16FB37d819B0A4dc</p>
                <p>🛒 Buyer: 0x9965507D1a55bcC2695C58ba16FB37d819B0A4dc</p>
                <p>💰 Price: 1.0 ETH</p>
                <p>📅 Contract Duration: 2 years</p>
                <p>✅ Payment Status: Pending</p>
            `;
            alert("🔍 Contract details fetched successfully!");

            // ✅ Enable the "Confirm Delivery" button after fetching details
            document.getElementById("confirmDeliveryBtn").disabled = false;
        });

        document.getElementById("confirmDeliveryBtn").addEventListener("click", function () {
            alert("✅ Delivery Confirmed!");
            this.disabled = true; // Disable the button after clicking
        });
    </script>

</body>
</html>
